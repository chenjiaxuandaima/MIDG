## Mask inpainting-based data generation architecture for surface defect images with complex backgrounds
[Paper](https://doi.org/10.1007/s11760-025-03987-y) | [BibTex](#citation)
### Introduction:
In the electronic manufacturing process, deep learning (DL)-based defect detection models often suffer from limited training defect datasets. To enhance training data, a novel mask inpainting-based data generation architecture (MIDG) is developed for surface defect images with complex backgrounds. It consists of a mask inpainting block, an edge generation block, followed by a defect generation module. The defect generation module is proposed based on an encoder-decoder model with an edge attention block, which hybridizes the information from inpainted normal images and edge maps simultaneously, where the first focuses on texture information and the second on edge structure, generated respectively from the mask inpainting and edge generation blocks. Besides, an annotation strategy is developed, which is at the rectangular mask level and can be easily executed. Experimental results demonstrate that our proposed method can generate various and high-quality defects on flexible printed circuit (FPC) surfaces with irregular circuit lines and copper-covered regions. After adding the generated samples to the training set, the mean Average Precision (mAP) of DL-based detection models such as Faster RCNN, YOLOv8, and YOLOv5 for FPC defect detection increases by 3.1%, 2.7%, and 3.0%, respectively. Detailed description can be found in our [paper](https://doi.org/10.1007/s11760-025-03987-y).

The architecture of our proposed method MIDG:
![Fig3](https://github.com/user-attachments/assets/6c4e08be-d3b6-464a-bf31-dd76a73ae305)

Comparison with excellent image inpainting methods:
![Fig6](https://github.com/user-attachments/assets/f95abe12-9aa3-4239-a6aa-a177164ddd19)

Display of various defect images generated by changing the position
and size of the mask:
![Fig9](https://github.com/user-attachments/assets/73c58ac3-307e-4d86-986d-94bb9b5863c3)

Display of defect images with controllable shapes:
![Fig10](https://github.com/user-attachments/assets/d8092d0c-97db-4efc-b0c3-b9d84b6246c3)

Display of various defect images generated by our proposed method:
![Fig11](https://github.com/user-attachments/assets/614d2e95-51c2-4ac5-be0e-7e36dc73296c)

Generated images during the process of our method:
![Fig12](https://github.com/user-attachments/assets/b0d7ea2f-5325-422e-a719-0410d2fa81b8)

Display of various defect images generated by changing the position:
![Fig13](https://github.com/user-attachments/assets/79cadc09-daac-4618-9760-07bcd919042c)

Other content will continue to be added.
