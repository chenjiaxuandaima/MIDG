## Mask inpainting-based data generation architecture for surface defect images with complex backgrounds
[Paper](https://doi.org/10.1007/s11760-025-03987-y) | [BibTex](#citation)
### Introduction:
In the electronic manufacturing process, deep learning (DL)-based defect detection models often suffer from limited training defect datasets. To enhance training data, a novel mask inpainting-based data generation architecture (MIDG) is developed for surface defect images with complex backgrounds. It consists of a mask inpainting block, an edge generation block, followed by a defect generation module. The defect generation module is proposed based on an encoder-decoder model with an edge attention block, which hybridizes the information from inpainted normal images and edge maps simultaneously, where the first focuses on texture information and the second on edge structure, generated respectively from the mask inpainting and edge generation blocks. Besides, an annotation strategy is developed, which is at the rectangular mask level and can be easily executed. Experimental results demonstrate that our proposed method can generate various and high-quality defects on flexible printed circuit (FPC) surfaces with irregular circuit lines and copper-covered regions. After adding the generated samples to the training set, the mean Average Precision (mAP) of DL-based detection models such as Faster RCNN, YOLOv8, and YOLOv5 for FPC defect detection increases by 3.1%, 2.7%, and 3.0%, respectively. Detailed description can be found in our [paper](https://doi.org/10.1007/s11760-025-03987-y).

The architecture of our proposed method MIDG:
<p align='center'>  
  <img src='https://github.com/user-attachments/assets/6c4e08be-d3b6-464a-bf31-dd76a73ae305' width='870'/>
</p>

### Generation Results:
This section showcases some generation results of the project.

Comparison with excellent image inpainting methods:
<p align='center'>  
  <img src='https://github.com/user-attachments/assets/f95abe12-9aa3-4239-a6aa-a177164ddd19' width='1070'/>
</p>


Display of various defect images generated by changing the position and size of the mask:

<p align='center'>  
  <img src='https://github.com/user-attachments/assets/73c58ac3-307e-4d86-986d-94bb9b5863c3' width='870'/>
</p>


Display of defect images with controllable shapes:

<p align='center'>  
  <img src='https://github.com/user-attachments/assets/d8092d0c-97db-4efc-b0c3-b9d84b6246c3' width='870'/>
</p>


Display of various defect images generated by our proposed method:

<p align='center'>  
  <img src='https://github.com/user-attachments/assets/614d2e95-51c2-4ac5-be0e-7e36dc73296c' width='870'/>
</p>


Generated images during the process of our method:

<p align='center'>  
  <img src='https://github.com/user-attachments/assets/b0d7ea2f-5325-422e-a719-0410d2fa81b8' width='670'/>
</p>


Display of various defect images generated by changing the position:

<p align='center'>  
  <img src='https://github.com/user-attachments/assets/79cadc09-daac-4618-9760-07bcd919042c' width='870'/>
</p>

## Prerequisites
- Python 3
- PyTorch
- NVIDIA GPU + CUDA cuDNN
## Installation
- Clone this repo:
```bash
git clone https://github.com/chenjiaxuandaima/MIDG.git
cd edge-connect
```
- Install PyTorch and dependencies from http://pytorch.org
- Install python requirements:
```bash
pip install -r requirements.txt
```
## Acknowledgments
This project is developed based on the [EC](https://github.com/knazeri/edge-connect.git) and LaMa projects. We sincerely appreciate their outstanding work.
## Citation
If you found our work helpful, please consider citing our papers <a href="https://doi.org/10.1007/s11760-025-03987-y">Mask inpainting-based data generation architecture for surface defect images with complex backgrounds</a> :

```

@InProceedings{Luo_2025_MIDG,
  title = {Mask inpainting-based data generation architecture for surface defect images with complex backgrounds},
  author = {Jiaxiang Luo,Jiaxuan Chen},
  journal={Signal, Image and Video Processing},
  year = {2025}
}
```
